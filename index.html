<!DOCTYPE html>
<html>
<head>
  <title>Visit Report Form</title>
  <style>
    body { font-family: Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; }
    .form-group { margin-bottom: 15px; }
    label { display: block; margin-bottom: 5px; font-weight: bold; }
    input, select, textarea { width: 100%; padding: 8px; box-sizing: border-box; }
    button { background: #4285f4; color: white; border: none; padding: 10px 15px; cursor: pointer; }
  </style>
</head>
<body>
  <h1>Visit Report Form</h1>
  <form id="visitForm">
    <div class="form-group">
      <label for="salesPerson">Sales Person*</label>
      <select id="salesPerson" required>
        <option value="">Select Sales Person</option>
        <option value="AKHIL MISHRA">AKHIL MISHRA</option>
        <option value="SANDEEP KUMAR">SANDEEP KUMAR</option>
        <option value="AJAY TIWARI">AJAY TIWARI</option>
        <option value="VIJAY TIWARI">VIJAY TIWARI</option>
      </select>
    </div>
    
    <div class="form-group">
      <label for="companyName">Company Name*</label>
      <input type="text" id="companyName" required>
    </div>
    
    <div class="form-group">
      <label for="name">Name*</label>
      <input type="text" id="name" required>
    </div>
    
    <div class="form-group">
      <label for="mobile">Mobile*</label>
      <input type="tel" id="mobile" required>
    </div>
    
    <div class="form-group">
      <label for="email">Email</label>
      <input type="email" id="email">
    </div>
    
    <div class="form-group">
      <label for="address">Address*</label>
      <textarea id="address" required></textarea>
    </div>
    
    <div class="form-group">
      <label for="city">City*</label>
      <input type="text" id="city" required>
    </div>
    
    <div class="form-group">
      <label for="state">State*</label>
      <input type="text" id="state" required>
    </div>
    
    <div class="form-group">
      <label for="pincode">PIN Code*</label>
      <input type="text" id="pincode" required>
    </div>
    
    <div class="form-group">
      <label for="materials">Materials Required*</label>
      <select id="materials" required>
        <option value="">Select Material</option>
        <option value="ACID RESISTANT MATERIALS">ACID RESISTANT MATERIALS</option>
        <option value="REFRACTORY MATERIALS">REFRACTORY MATERIALS</option>
        <option value="INDUSTRIAL FLOORING TILES">INDUSTRIAL FLOORING TILES</option>
        <option value="EPOXY COATINGS">EPOXY COATINGS</option>
        <option value="ACID RESISTANT AND REFRACTORY MATERIALS">ACID RESISTANT AND REFRACTORY MATERIALS</option>
      </select>
    </div>
    
    <div class="form-group">
      <label for="visitingCard">Visiting Card (Image)*</label>
      <input type="file" id="visitingCard" accept="image/*" capture="camera" required>
    </div>
    
    <div class="form-group">
      <label for="remarks">Remarks</label>
      <textarea id="remarks"></textarea>
    </div>
    
    <div class="form-group">
      <label for="location">Location (Auto-detected)</label>
      <input type="text" id="location" readonly>
      <small>Location will be automatically captured when you submit the form</small>
    </div>
    
    <button type="submit">Submit Report</button>
  </form>

  <script>
    document.getElementById('visitForm').addEventListener('submit', async function(e) {
      e.preventDefault();
      
      // Get location
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(async function(position) {
          const latitude = position.coords.latitude;
          const longitude = position.coords.longitude;
          
          // Get address from coordinates
          const response = await fetch(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${latitude},${longitude}&key=YOUR_GOOGLE_API_KEY`);
          const data = await response.json();
          const address = data.results[0]?.formatted_address || 'Location not available';
          
          document.getElementById('location').value = address;
          
          // Now submit the form data
          await submitForm(latitude, longitude, address);
        }, function(error) {
          alert('Error getting location: ' + error.message);
        });
      } else {
        alert('Geolocation is not supported by this browser.');
      }
    });
    
    async function submitForm(latitude, longitude, address) {
      const formData = new FormData();
      formData.append('salesPerson', document.getElementById('salesPerson').value);
      formData.append('companyName', document.getElementById('companyName').value);
      formData.append('name', document.getElementById('name').value);
      formData.append('mobile', document.getElementById('mobile').value);
      formData.append('email', document.getElementById('email').value);
      formData.append('address', document.getElementById('address').value);
      formData.append('city', document.getElementById('city').value);
      formData.append('state', document.getElementById('state').value);
      formData.append('pincode', document.getElementById('pincode').value);
      formData.append('materials', document.getElementById('materials').value);
      formData.append('remarks', document.getElementById('remarks').value);
      formData.append('location', address);
      formData.append('latitude', latitude);
      formData.append('longitude', longitude);
      
      const fileInput = document.getElementById('visitingCard');
      if (fileInput.files.length > 0) {
        formData.append('visitingCard', fileInput.files[0]);
      }
      
      try {
        const response = await fetch('YOUR_GOOGLE_APPS_SCRIPT_URL', {
          method: 'POST',
          body: formData
        });
        
        if (response.ok) {
          alert('Form submitted successfully!');
          document.getElementById('visitForm').reset();
        } else {
          alert('Error submitting form');
        }
      } catch (error) {
        alert('Error: ' + error.message);
      }
    }
  </script>
</body>
</html>
